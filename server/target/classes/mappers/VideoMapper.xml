<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.SOOKTUBE.dao.VideoDAO">
 
    <insert id="newVideo"
            parameterType="com.SOOKTUBE.model.VideoDTO"
            useGeneratedKeys="true"
            keyProperty="videoID">
        INSERT INTO VIDEO(`videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`)
        VALUES (#{videoTitle}, #{videoDesc}, CURRENT_TIMESTAMP, #{username}, #{uploadFileName})
    </insert>

    
        <select id="getDescbyVideoID" 
    		parameterType="Integer" 
    		resultType="com.SOOKTUBE.model.VideoDTO">
    		
    		SELECT `videoID`, `videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`, `videoPath`
    		FROM VIDEO
    		WHERE `videoID` = #{videoID}
    		
    		</select>
    		
        <select id="getDescbyUser" 
    		parameterType="String" 
    		resultType="com.SOOKTUBE.model.VideoDTO">
    		
    		SELECT `videoID`, `videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`, `videoPath`
    		FROM VIDEO
    		WHERE `username` = #{username, jdbcType=VARCHAR}
    		
    		</select>
    		
    		
    	        <select id="getDescbyFile" 
    		parameterType="String" 
    		resultType="com.SOOKTUBE.model.VideoDTO">
    		
    		SELECT `videoID`, `videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`, `videoPath`
    		FROM VIDEO
    		WHERE `uploadFileName` = #{uploadFileName}
    		
    		</select>	
    	    		
         <select id="getDescbyListID" 
    		parameterType="Integer" 
    		resultType="com.SOOKTUBE.model.VideoDTO">
    		
    		SELECT listInfo.`listID`, VIDEO.`videoID`, `videoTitle`, `videoDesc`, `videoDate`, VIDEO.`username`, `uploadFileName`, `videoPath`
    		FROM VIDEO, listInfo, videoList
    		WHERE listInfo.`listID` = #{listID}
    			AND
    				videoList.`videoID` = VIDEO.`videoID`
    		
    		</select>
    		   
    <select id="getURLfromVideoID" 
    		parameterType="Integer" 
    		resultType="String">
    		
    		SELECT `uploadFileName`
    		FROM VIDEO
    		WHERE `videoID` = #{videoID}
    		
    		</select>
    		
        <select id="getURLfromUsername" 
    		parameterType="String" 
    		resultType="String">
    		
    		SELECT `uploadFileName`
    		FROM VIDEO
    		WHERE `username` = #{username}
    		
    		</select>
    		
    		
    	<select id="getURLfromFilename"
    			parameterType="String"
    			resultType="String">
    			
    			SELECT `uploadFileName`
    			FROM VIDEO
    			WHERE `uploadFileName` = #{uploadFileName}
    			
    			</select>


    	<select id="getURLfromTitle"
    			parameterType="String"
    			resultType="String">
    			
    			SELECT `uploadFileName`
    			FROM VIDEO
    			WHERE `videoTitle` = #{videoTitle}
    			
    			</select>    			
    			
    	<select id="searchVideobyTitle"
    			parameterType="String"
    			resultType="com.SOOKTUBE.model.VideoDTO">
    			
    			SELECT `videoID`, `videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`, `videoPath`
    			FROM VIDEO
    			WHERE `videoTitle` LIKE CONCAT('%',#{videoTitle},'%')

    			
    			</select>
    			
<!--     	 <select id="getVideoPath"
    			parameterType="Integer"
    			resultType="String">
    			
    			SELECT `videoPath`
    			FROM VIDEO
    			WHERE `uploadFileName` = #{uploadFileName}
    			
    			</select>	 -->	
    			
    			
    	    <update id="editVideo" parameterType="com.SOOKTUBE.model.VideoDTO">
        UPDATE VIDEO
           SET `videoTitle` = #{videoTitle}
             , `videoDesc` = #{videoDesc}
             , `videoDate` = #{videoDate}
         WHERE `videoID` = #{videoID}
    </update>
    
    
    <delete id="deleteVideobyID"> 
    	DELETE FROM VIDEO
    	WHERE videoID = #{videoID}
    </delete>
    			
    <delete id="deleteVideobyFileName">
    	DELETE FROM VIDEO
    	WHERE uploadFileName = #{uploadFileName}
    </delete>

    

</mapper>


<!-- videoID int(11) PK 
videoTitle varchar(20) 
videoDesc text 
videoDate date 
userID varchar(50) -->