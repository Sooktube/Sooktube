<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.SOOKTUBE.dao.ListCommentDAO">

    <insert id="commentList"
            parameterType="com.SOOKTUBE.model.ListCommentDTO"
            useGeneratedKeys="true"
            keyProperty="commentID">
            
            INSERT INTO listComments(`listID`, `username`, `userComment`, `commentDate`)
            VALUES(#{listID}, #{username}, #{userComment}, CURRENT_TIMESTAMP)
            
    </insert>
    
    <update id="editListComment" parameterType="com.SOOKTUBE.model.ListCommentDTO">
        UPDATE listComments
           SET `userComment` = #{userComment}
             , `commentDate` = CURRENT_TIMESTAMP
         WHERE `listID` = #{listID}
         AND `username` = #{username}
         AND `commentID` = #{commentID}
    </update>


	<select id="getComments"
		    	resultType="com.SOOKTUBE.model.ListCommentDTO">
		    	
		SELECT `commentID`, `listID`, `userComment`, `username`, `commentDate`
		FROM listComments
		WHERE `commentID` = #{commentID}
		    AND `listID` = #{listID}
		    	AND `username` = #{username}
		    	
	</select>
	
	<select id="getCommentsByListID"
		    	resultType="com.SOOKTUBE.model.ListCommentDTO">
		    	
		SELECT `commentID`, `listID`, `userComment`, `username`, `commentDate`
		FROM listComments
		WHERE `listID` = #{listID}
		    	
	</select>
	
    <delete id="deleteListComment"> 
    	DELETE FROM listComments
		WHERE `commentID` = #{commentID}
		    AND `listID` = #{listID}
		    	AND `username` = #{username}
    </delete>

</mapper>