<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.SOOKTUBE.dao.VideoListDAO">



			<insert id="newList"
		            parameterType="com.SOOKTUBE.model.VideoListDTO">
		        INSERT INTO videoList(`listID`, `videoID`, `username`)
		        VALUES (#{listID}, #{videoID}, #{username})
		    </insert>
		    
		    <insert id="newListInfo"
		            parameterType="com.SOOKTUBE.model.VideoListDTO"
		            useGeneratedKeys="true"
            		keyProperty="listID">
		        INSERT INTO listInfo(`listName`, `listDesc`, `isPublic`, `thumbnail`)
		        VALUES (#{listName}, #{listDesc}, #{isPublic},  #{thumbnail})
		    </insert>
	
		    
		    <select id="getVideoList"
		    resultType="com.SOOKTUBE.model.VideoListDTO">
    		
			SELECT videoList.`listID`, `videoID`, `listName`, `listDesc`, videoList.`username`, `isPublic`, `thumbnail`
			FROM videoList, listInfo, user
			WHERE videoList.`listID` = listInfo.`listID`
				AND
					videoList.`username` = user.`username`
    		
    		</select>
    		
    		<select id="getVideoListbyID"
    		parameterType="Integer"
		    resultType="com.SOOKTUBE.model.VideoListDTO">
    		
			SELECT videoList.`listID`, videoList.`videoID`, `listName`, `listDesc`, VIDEO.`username`, `isPublic`, `thumbnail`, `uploadFileName`
			FROM videoList, listInfo, VIDEO
			WHERE listInfo.`listID` = 1
			AND listInfo.`listID` = videoList.`listID`
            AND VIDEO.`videoID` = videoList.`videoID`

    		
    		</select>


    		<select id="getVideoListbyVideoID"
    		parameterType="Integer"
		    resultType="com.SOOKTUBE.model.VideoListDTO">
    		
			SELECT videoList.`listID`, videoList.`videoID`, `listName`, `listDesc`, videoList.`username`, `isPublic`, `thumbnail`, `like`, `dislike`
			FROM videoList, listInfo
			WHERE videoList.`listID` = #{listID}
			AND `videoID` = #{videoID}
			AND videoList.`listID` = listInfo.`listID`

    		
    		</select>
    		
    		 
    		<select id="getListbyID"
    		parameterType="Integer"
		    resultType="com.SOOKTUBE.model.VideoListDTO">
    		
			SELECT DISTINCT
			     videoList.`listID`, `listName`, `listDesc`, `username`, `isPublic`, `thumbnail`
			FROM videoList, listInfo
			WHERE videoList.`listID` = #{listID}

    		
    		</select> 
 
    		
    		<select id="getFileNamebylistID"
    		parameterType="Integer"
		    resultType="String">
    		
			SELECT `uploadFileName`
			FROM videoList, VIDEO
			WHERE `listID` = #{listID}
				AND
					videoList.`videoID` = VIDEO.`videoID`
    		
    		</select>


    		<select id="getFileNamebylistIDGTEQ5"
    		parameterType="Integer"
		    resultType="String">
    		
			SELECT `uploadFileName`
			FROM videoList, VIDEO
			WHERE `listID` = #{listID}
				AND
					videoList.`videoID` = VIDEO.`videoID`
				AND videoList.`like` + videoList.`dislike` &gt;= 5
    		
    		</select>

    		<select id="getFileNamebylistIDbetween0and5"
    		parameterType="Integer"
		    resultType="String">
    		
			SELECT `uploadFileName`
			FROM videoList, VIDEO
			WHERE `listID` = #{listID}
				AND
					videoList.`videoID` = VIDEO.`videoID`
				AND videoList.`like` + videoList.`dislike` BETWEEN 0 AND 4
    		
    		</select>

    		<select id="getFileNamebylistName"
    		parameterType="String"
		    resultType="String">
    		
			SELECT `uploadFileName`
			FROM videoList, VIDEO, listInfo
			WHERE `listName` = #{listName}
				AND
					videoList.`listID` = listInfo.`listID`
				AND
					videoList.`videoID` = VIDEO.`videoID`
    		
    		</select>
    		
    		    		
    	<select id="searchListbyTitle"
    			parameterType="String"
    			resultType="com.SOOKTUBE.model.VideoListDTO">
    			
    			SELECT videoList.`listID`, `videoID`, `listName`, `listDesc`, videoList.`username`, `isPublic`
    			FROM videoList, listInfo
    			WHERE `listName` LIKE CONCAT('%',#{listName},'%')

    			
    			</select>  
    			
		
    		
    		
<!--     		<insert id="newVideo"
            parameterType="com.SOOKTUBE.model.VideoDTO"
            useGeneratedKeys="true"
            keyProperty="videoID">
		        INSERT INTO videoList(`videoTitle`, `videoDesc`, `videoDate`, `username`, `uploadFileName`)
		        VALUES (#{videoTitle}, #{videoDesc}, #{videoDate}, #{username}, #{uploadFileName})
		    </insert> -->
		    
		    
    	    <update id="editLike" parameterType="int">
		        UPDATE videoList
		           SET `like` = `like` + 1
		         WHERE `listID` = #{listID}
		         AND `videoID` = #{videoID}
		    </update>

    	    <update id="editDislike" parameterType="int">
		        UPDATE videoList
		           SET `dislike` = `dislike` - 1
		         WHERE `listID` = #{listID}
		         AND `videoID` = #{videoID}
		    </update>

    <delete id="deleteVideoFromlist">
    	DELETE FROM videoList
    	WHERE videoID = #{videoID}
    	AND listID = #{listID}
    </delete>


</mapper>